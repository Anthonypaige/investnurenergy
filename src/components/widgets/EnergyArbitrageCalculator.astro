---
import WidgetWrapper from '../ui/WidgetWrapper.astro';
---
<WidgetWrapper>
    <style>
        h1 {
          color: #fff;
          text-align: center;
          font-size: 24px;
          margin-bottom: 20px;
        }
        form {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          background-color: #444;
          padding: 20px;
          border-radius: 5px;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .input-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
        }
        .input-group {
          flex: 0 0 calc(50% - 10px);
          margin-bottom: 20px;
        }
        label, input {
          color: #fff;
        }
        label {
          display: inline-block;
          width: 55%;
          text-align: right;
          margin-right: 5px;
        }
        input {
          width: 30%;
        }
        button {
          background-color: #4CAF50;
          color: white;
          padding: 10px 20px;
          border: none;
          cursor: pointer;
          border-radius: 5px;
          width: 100%;
          font-size: 16px;
        }
        button:hover {
          background-color: #45a049;
        }
        #results {
          background-color: #444;
          padding: 20px;
          border-radius: 5px;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
          margin-top: 20px;
        }
      </style>
      
      
      

    <!-- Rest of your component -->
 
  
    <h1>The Energy Arbitrage Savings Calculator</h1>
    <form id="calculator-form">
      <div class="input-container">
        <div class="input-group">
          <label for="batteryCapacity">Battery Usable Capacity (kWh):</label>
          <input type="number" id="batteryCapacity" required>
        </div>
        <div class="input-group">
          <label for="peakRate">Peak Rate (cents/kWh):</label>
          <input type="number" id="peakRate" required>
        </div>
        <div class="input-group">
          <label for="offPeakRate">Off-Peak Rate (cents/kWh):</label>
          <input type="number" id="offPeakRate" required>
        </div>
        <div class="input-group">
          <label for="summerPeakHours">Summer Peak Hours:</label>
          <input type="number" id="summerPeakHours" required>
        </div>
        <div class="input-group">
          <label for="nonSummerPeakHours">Non-Summer Peak Hours:</label>
          <input type="number" id="nonSummerPeakHours" required>
        </div>
        <div class="input-group">
          <label for="averageConsumption">Avg Consumption/Hour (kWh):</label>
          <input type="number" id="averageConsumption" required>
        </div>
      </div>
      <button type="submit">Calculate</button>
    </form>
    <h2>Results:</h2>
    <p id="results"></p>
  

    <script type="module">
      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('calculator-form');
        form.addEventListener('submit', function(event) {
          event.preventDefault();
          calculateSavings();
        });
  
        function calculateSavings() {
          // Use type assertion to tell TypeScript the specific type of the element
          const batteryCapacityElement = document.getElementById('batteryCapacity') as HTMLInputElement;
          const peakRateElement = document.getElementById('peakRate') as HTMLInputElement;
          const offPeakRateElement = document.getElementById('offPeakRate') as HTMLInputElement;
          const summerPeakHoursElement = document.getElementById('summerPeakHours') as HTMLInputElement;
          const nonSummerPeakHoursElement = document.getElementById('nonSummerPeakHours') as HTMLInputElement;
          const averageConsumptionElement = document.getElementById('averageConsumption') as HTMLInputElement;
  
          // Now TypeScript knows that these are input elements and they have a 'value' property
          const batteryCapacity = parseFloat(batteryCapacityElement.value);
          const peakRate = parseFloat(peakRateElement.value);
          const offPeakRate = parseFloat(offPeakRateElement.value);
          const summerPeakHours = parseFloat(summerPeakHoursElement.value);
          const nonSummerPeakHours = parseFloat(nonSummerPeakHoursElement.value);
          const averageConsumption = parseFloat(averageConsumptionElement.value);
  
          if (isNaN(batteryCapacity) || isNaN(peakRate) || isNaN(offPeakRate) ||
              isNaN(summerPeakHours) || isNaN(nonSummerPeakHours) || isNaN(averageConsumption)) {
            document.getElementById("results").innerText = "Please enter all fields correctly.";
            return;
          }
  
          const summerDays = 122;
          const nonSummerDays = 243;
  
          const savingsPerKWh = peakRate - offPeakRate;
  
          const summerSavings = savingsPerKWh * averageConsumption * summerPeakHours * summerDays;
          const nonSummerSavings = savingsPerKWh * averageConsumption * nonSummerPeakHours * nonSummerDays;
  
          const totalSavings = summerSavings + nonSummerSavings;
  
          document.getElementById("results").innerText = "Total Savings Per Year: $" + totalSavings.toFixed(2);
        }
      });
    </script>
  </WidgetWrapper>